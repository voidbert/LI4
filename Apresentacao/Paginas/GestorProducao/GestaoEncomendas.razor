@page "/GestorProducao/GestaoEncomendas"

@using LI4.Apresentacao.Componentes

@namespace LI4.Apresentacao.Paginas.GestorProducao

<h1>Gestão de Encomendas</h1>
<table>
    <thead>
        <tr>
            <th>Item:</th>
            <th>Estado:</th>
            <th>Conteúdo:</th>
            <th>Preço:</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var encomenda in Encomendas)
        {
            <tr>
                <td>
                    <strong style="color: red;">@encomenda.Nome</strong><br />
                    Cliente: @encomenda.Cliente<br />
                    Data: @encomenda.Data
                </td>
                <td class="estado @encomenda.EstadoClass">
                    @encomenda.Estado<br />
                    @if (!string.IsNullOrEmpty(encomenda.DataEstado))
                    {
                        <small>@encomenda.DataEstado</small>
                    }
                </td>
                <td>
                    @foreach (var item in encomenda.Conteudo)
                    {
                        <div>
                            ● @item.Nome - Id: @item.Id x@item.Quantidade
                        </div>
                    }
                </td>
                <td>
                    @encomenda.Preco$<br />
                    <div class="acoes">
                        <button class="btn-aprovar" @onclick="@(() => AprovarEncomenda(encomenda))">✔</button>
                        <button class="btn-rejeitar" @onclick="@(() => RejeitarEncomenda(encomenda))">✖</button>
                    </div>
                </td>
            </tr>
        }
    </tbody>
</table>
<div class="container">
    <LinkButton Href="/" />
</div>

@code {
    private List<Encomenda> Encomendas { get; set; } = new List<Encomenda>
    {
        new Encomenda
        {
            Nome = "Encomenda 1",
            Cliente = "Cliente 1",
            Data = "06/10/2024 10h00",
            Estado = "Entregue",
            EstadoClass = "entregue",
            DataEstado = "06/10/2024 10h00",
            Preco = 100,
            Conteudo = new List<Item>
            {
                new Item { Nome = "EVA 1", Id = 101001, Quantidade = 2 },
                new Item { Nome = "EVA 1", Id = 101001, Quantidade = 2 }
            }
        },
        new Encomenda
        {
            Nome = "Encomenda 1",
            Cliente = "Cliente 1",
            Data = "06/10/2024 10h00",
            Estado = "Devolvida",
            EstadoClass = "devolvido",
            DataEstado = "06/10/2024 10h00",
            Preco = 100,
            Conteudo = new List<Item>
            {
                new Item { Nome = "EVA 1", Id = 101001, Quantidade = 2 },
                new Item { Nome = "EVA 1", Id = 101001, Quantidade = 2 }
            }
        },
        // Adicione outras encomendas aqui...
    };

    private void AprovarEncomenda(Encomenda encomenda)
    {
        encomenda.Estado = "Aprovada";
        encomenda.EstadoClass = "aprovado";
    }

    private void RejeitarEncomenda(Encomenda encomenda)
    {
        encomenda.Estado = "Rejeitada";
        encomenda.EstadoClass = "rejeitado";
    }

    private class Encomenda
    {
        public string Nome { get; set; }= string.Empty; 
        public string Cliente { get; set; }= string.Empty; 
        public string Data { get; set; }= string.Empty;
        public string Estado { get; set; }= string.Empty; 
        public string EstadoClass { get; set; }= string.Empty; 
        public string DataEstado { get; set; }= string.Empty;
        public decimal Preco { get; set; }
        public List<Item> Conteudo { get; set; }= new List<Item>();
    }

    private class Item{
        public string Nome { get; set; }= string.Empty;
        public int Id { get; set; }
        public int Quantidade { get; set; }
    }
}
